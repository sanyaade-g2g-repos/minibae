/**********
     TITLE: Music Object Component - Advanced
   VERSION: 3.4.0.7
    AUTHOR: Chris van Rensburg
 COPYRIGHT: 1996-2001 Beatnik, Inc. All Rights Reserved
  REQUIRES: Music Object Component - Basic
**********/

function MO_z(_bu,_bv){var _f=new Array();for(var _bw=0;_bw<_bu;_bw++)_f[_bw]=(typeof _bv=='function')?new _bv():eval(_bv);return _f;}function mo_extend(){for(var _bx=0;_bx<MO_j._by.length;_bx++)MO_j._by[_bx](this);}function MO_A(_bz){MO_j._by[MO_j._by.length]=_bz;}function MO_B(){var _bn=MO_B.arguments,_bA=true,_bf=MO_j.publicInstanceCallbacks;for(var _bp=0;_bp<_bn.length;_bp++){var _bB=_bn[_bp];
if(_bB.charAt(0)=='['){_bA=_bB.toLowerCase().indexOf('instance')!= -1;_bf=MO_j['public'+(_bA?'Instance':'Static')+'Callbacks'];}else{_bf[_bf.length]=_bB;window['mo_'+_bB]=new Function('handler',(_bA?'this.':'Music.')+_bB+'Handler = handler;'+((_bA&&_bB=='onMetaEvent')?'this.updateMetaEventsEnabled ();':''));_bA?MO_u(_bB):MO_t(_bB);}}}function mo_updateMetaEventsEnabled(){if(this.ready)this._b.enableMetaEvents(typeof this.onMetaEventHandler=='function'||(typeof this.onMetaEventHandlers!=MO_b&&this.onMetaEventHandlers.length>0));}function mo_addCallbackHandler(_bC,_l){var _q=MO_c(this),_bD=_bC+'Handlers';if(typeof _q[_bD]==MO_b)_q[_bD]=new Array();_q[_bD][_q[_bD].length]=_l;if(_bC=='onMetaEvent')_q.updateMetaEventsEnabled();}function MO_C(_l){if(typeof _l=='string')eval(_l);else if(typeof _l=='function')_l();}function mo_execCallback(_bC){var _q=MO_c(this);if(typeof _q[_bC+'Handler']!=MO_b)MO_C(_q[_bC+'Handler']);if(typeof _q[_bC+'Handlers']!=MO_b){var _bE=_q[_bC+'Handlers'];for(var _bF=0;_bF<_bE.length;_bF++)
MO_C(_bE[_bF]);}}function mo_updateAudibleState(){var _q=this;MO_D(_q,'updateAudibleStateTimeout');var _bG=_q.audible;_q.audible=((_q.usage!='notes'&&_q.isPlaying())||_q._bH>0)&&_q._D>0;if(_q.audible!=_bG)_q.execCallback('onAudibleStateChange');}function mo_execOnMetaEvent(_k,_bI){if(typeof this.onMetaEventHandler=='function')this.onMetaEventHandler(_k,_bI,this);this.execMetaEventHandlers(_k,_bI);}function mo_execOnPause(){this.endVolumeFade();this.updateAudibleState();this.execCallback('onPause');}function mo_execOnStop(){this.endVolumeFade();this.updateAudibleState();this.execCallback('onStop');}function mo_stopAll(){for(var _Y=0;_Y<MO_j.instances.length;_Y++)MO_j.instances[_Y].stop();}function MO_E(_bJ){var _q=this;if(Math.round(_bJ)!=Math.round(_q._bK)){_q.fadeValue=Math.round(_bJ);if(typeof _q._bL=='function')_q._bL(_q.fadeValue);}_q._bK=_bJ;}function MO_F(){var _q=this;if(_q.inProgress){_q.inProgress=false;MO_C(_q._bM);if(_q._bN)_q.setValue(_q._bO);}}function MO_G(){var _q=this;if(_q.inProgress){
_q.setValue(_q._bK+_q._bP);_q.timeElapsed+=MO_j.minFadeInterval;if(_q.timeElapsed>=_q._bQ)_q.end();}return _q.inProgress;}function mo_execFades(){MO_j._bR=setTimeout('mo_execFades ()',MO_j.minFadeInterval);var _bS=0,_bT=0;while(_bT<MO_j._bU.length-_bS){MO_j._bU[_bT]=MO_j._bU[_bT+_bS];(MO_j._bU[_bT].advance())?_bT++ :_bS++;}MO_j._bU.length-=_bS;if(typeof MO_j.onFadesUpdatedHandler!=MO_b)MO_C(MO_j.onFadesUpdatedHandler);if(MO_j._bU.length==0)clearTimeout(MO_j._bR);}function MO_H(){var _q=this;if(!_q.inProgress){_q.inProgress=true;if(_q._bQ==0){if(!_q._bN)_q.setValue(_q._bV);_q.end();}else{_q.timeElapsed=0;_q.setValue(_q._bO);MO_j._bU[MO_j._bU.length]=_q;if(MO_j._bU.length==1)setTimeout('mo_execFades ()',MO_j.minFadeInterval);}}}function MO_I(_bO,_bV,_bQ,_bL,_bM,_bN){var _q=this;if(typeof _bV!='number')_bV=0;if(typeof _bQ=='boolean')_bQ=_bQ?1000:0;if(typeof _bQ!='number')_bQ=1000;if(typeof _bN!='boolean')_bN=false;_bL=(typeof _bL=='string')?new Function('fadeValue',_bL):_bL;if(_q.inProgress&&_q._bV==_bV&&
_q._bQ==_bQ){_q._bM=_bM;_q._bL=_bL;}else{var _bW=_q.inProgress;_q.end();_q._bN=_bN;_q._bO=_bO;_q._bV=_bV;_q._bQ=Math.round(_bQ/MO_j.minFadeInterval)*MO_j.minFadeInterval;_q._bM=_bM;_q._bL=_bL;_q._bK= -1000;_q._bP=(_bV-_bO)/(_q._bQ/MO_j.minFadeInterval);if(_bW)_q.start();}}function MO_J(_bO,_bV,_bQ,_bL,_bM,_bN){var _q=this;_q.inProgress=false;_q.fadeValue=_bO;_q.start=MO_H;_q.end=MO_F;_q.advance=MO_G;_q.setValue=MO_E;_q.update=MO_I;if(MO_J.arguments.length>0)_q.update(_bO,_bV,_bQ,_bL,_bM,_bN);}function mo_endVolumeFade(){this._bX.end()}function mo_fadeVolume(_bY,_bZ,_bQ,_b0,_b1){if(typeof _b1!=MO_b)this.onOutputVolumeChangeHandler=_b1;this._bX.update((typeof _bY!='number')?this.VOLUME:_bY,_bZ,_bQ,this.objectName+'.setVolume (fadeValue)',_b0,typeof _b0=='string'&&(_b0.indexOf('.stop ()')!= -1||_b0.indexOf('.pause ()')!= -1));this._bX.start();}function mo_fadeTo(_b2,_bQ,_b3,_b4){this.fadeVolume(null,_b2,_bQ,_b3,_b4);}function mo_setMonophonic(_b5,_b6){if(_b5==0)for(var _b7=1;_b7<17;_b7++)this._b8[_b7]=_b6;
else this._b8[_b5]=_b6;}function mo_getMonophonic(_b5){return this._b8[_b5]}function mo_noteOn(_b5,_p,_b9,_ca,_cb,_cc){var _q=this;if(_q.on()){var _cd,_ce=MO_j._ce,_cf=MO_j._cf;if(mo_noteOn.arguments.length>=5){if(_q._b8[_b5])_q.noteOff(_b5);if(typeof _ca=='string')_ca=mo_getNoteNumber(_ca);_cf._cg=_q;_cf._ch= ++MO_j._ci;_cf._b5=_b5;_cf._cj=_ca;var _ck= -1;for(_cd=0;_cd<MO_j._cl;_cd++){if(_ce[_cd]._b5==0){_ck=_cd;break;}}if(_ck== -1){_ck=0;for(_cd=0;_cd<MO_j._cl;_cd++){if(_ce[_cd]._ch<_ce[_ck]._ch)_ck=_cd;}_ce[_ck].free();}var _cm=_ce[_ck];_cm._cg=_cf._cg;_cm._ch=_cf._ch;_cm._b5=_cf._b5;_cm._cj=_cf._cj;(_p>=0&&_b9>=0)?_q._b.noteOn(_b5,_p,_b9,_ca,_cb):_q._b.noteOn(_b5,_ca,_cb);if(typeof _cc=='number')_cm.noteOffTimeout=setTimeout('Music.voices ['+_ck+'].free ()',_cc);_q._bH++;_q.updateAudibleState();}else{_q.noteOn(_b5,-1,-1,_p,_b9,(typeof _ca!='number')?null:_ca);}}}function mo_noteOff(_b5,_cj){if(this.on()){if(typeof _cj=='string')_cj=mo_getNoteNumber(_cj);if(typeof _cj!='number')_cj= -1;
for(var _cd=0;_cd<MO_j._cl;_cd++){var _cm=MO_j._ce[_cd];if(_cm._cg==this&&_cm._b5==_b5&&(_cm._cj==_cj||_cj== -1))_cm.free();}}}function mo_setProgram(_b5,_p,_b9){if(this.on()){(typeof _b9=='number')?this._b.setProgram(_b5,_p,_b9):this._b.setProgram(_b5,_p);}}function mo_isPaused(){return this.ready?this._b.IsPaused():false}function mo_isPlaying(){return this.ready?this._b.IsPlaying():false}function mo_stubEmbed(_cn,_co){this.magicEmbed(((typeof _cn!='string')?'':('SRC="'+_cn+'" '))+'WIDTH=0 HEIGHT=0 HIDDEN AUTOSTART=TRUE LOOP=TRUE '+((typeof _co=='string')?_co:''));}function mo_preloadEmbed(_cn,_co){this.stubEmbed(_cn,'AUTOSTART=FALSE LOOP=FALSE '+((typeof _co=='string')?_co:''));}function mo_getNoteName(_cp){var _cq=new Array('C','C#','D','D#','E','F','F#','G','G#','A','A#','B');return _cq[_cp%12]+(Math.floor(_cp/12)-1);}function mo_getNoteNumber(_cr){if(typeof _cr=='number')return _cr;var _cs='c-d-ef-g-a-b'.indexOf(_cr.charAt(0).toLowerCase()),_f=0,_ct=0;if(_cs!= -1){var _cu=_cr.indexOf('b',1);if(_cu== -1){
_cu=_cr.indexOf('#',1);(_cu== -1)?(_cu=0):(_ct=1);}else{_ct= -1;}var _cv=_cr.substring(_cu+1)-0;_f=12+_cv*12+_cs+_ct;}return Math.floor(_f);}function MO_D(_cw,_cx){if(typeof _cw[_cx]!=MO_b&&_cw[_cx]!=null)clearTimeout(_cw[_cx]);_cw[_cx]=null;}function MO_K(){var _q=this;MO_D(_q,'noteOffTimeout');_q._cg._b.noteOff(_q._b5,_q._cj,127);_q._b5=0;_q._cg._bH--;MO_D(_q._cg,'updateAudibleStateTimeout');_q._cg.updateAudibleStateTimeout=setTimeout(_q._cg.objectName+'.updateAudibleState ()',_q._cg.averageNoteRelease);}function MO_L(){var _q=this;_q._cg=null;_q._b5=_q._cj=0;_q._ch=0;_q.free=MO_K;}function MO_M(){mo_stopAll();MO_j.enabled=false;}function mo_setAudioDevicePriority(_cy){if(MO_j._be&&MO_N())MO_j.global.setAudioDevicePriority(_cy);MO_j.embedDefaults.AUDIODEVICEPRIORITY=_cy;}function mo_engageAudio(_cz){if(MO_N())MO_j.global.engageAudio(_cz);MO_j.embedDefaults.AUDIOENGAGED=_cz;MO_j.execCallback('onEngageAudio');}function mo_isAudioDeviceShared(){var _Z=MO_j,_cA=MO_w.userAgent;
return _Z._be?(MO_N()?_Z.global.isAudioDeviceShared():null):(_Z.stringHasAny(_cA,'WinNT','Windows NT')?_Z.meetsMinVersion(_Z.retrieveVersion(_cA,1,MO_d(_cA,(_cA.indexOf('WinNT')!= -1)?'WinNT':'Windows NT')),'5.0'): !_Z.stringHasAny(_cA,'Win9','Windows 9'));}function mo_isAudioSupported(){return(MO_j._be&&MO_N())?MO_j.global.isAudioSupported():true;}function MO_N(){return MO_j.enabled&&MO_j.global!=null}function mo_doMenuItem(_cB){if(this.on())this._b.doMenuItem(_cB)}function mo_getAudioDevicePriority(){return MO_j.embedDefaults.AUDIODEVICEPRIORITY}function mo_getAutostart(){return this.ready?this._b.getAutostart():null}function mo_getChannelMute(_b5){return this.ready?this._b.getChannelMute(_b5):null}function mo_getChannelSolo(_b5){return this.ready?this._b.getChannelSolo(_b5):null}function mo_getController(_b5,_cC){return this.ready?this._b.getController(_b5,_cC):null}function mo_getFileSize(){return this.ready?this._b.getFileSize():null}function mo_getInfo(_cD){return this.ready?this._b.getInfo(_cD):null}
function mo_getLoop(){return this.ready?this._b.getLoop():null}function mo_getPanelDisplay(){return this.ready?this._b.getPanelDisplay():null}function mo_getPanelMode(){return this.ready?this._b.getPanelMode():null}function mo_getPlayer(){return this._b}function mo_getPlayLength(){return this.ready?this._b.getPlayLength():null}function mo_getPosition(){return this.ready?this._b.getPosition():null}function mo_getProgram(_b5){return this.ready?this._b.getProgram(_b5):null}function mo_getReverbType(){return MO_N()?MO_j.global.getReverbType():null}function mo_getTempo(){return this.ready?this._b.getTempo():null}function mo_getTrackMute(_cE){return this.ready?this._b.getTrackMute(_cE):null}function mo_getTrackSolo(_cE){return this.ready?this._b.getTrackSolo(_cE):null}function mo_getTransposable(_b5){return this.ready?this._b.getTransposable(_b5):null}function mo_getTranspose(){return this.ready?this._b.getTranspose():null}function mo_isAudioEngaged(){return(MO_N()&&MO_j._be)?MO_j.global.isAudioEngaged():null}
function mo_setAutostart(_b6){if(this.on())this._b.setAutostart(_b6)}function mo_setChannelMute(_b5,_b6){if(this.on())this._b.setChannelMute(_b5,_b6)}function mo_setChannelSolo(_b5,_b6){if(this.on())this._b.setChannelSolo(_b5,_b6)}function mo_setController(_b5,_cC,_cF){if(this.on())this._b.setController(_b5,_cC,_cF)}function mo_setEndTime(_cG){if(this.on())this._b.setEndTime(_cG)}function mo_setGlobalMute(_cH){if(MO_N())MO_j.global.setGlobalMute(_cH)}function mo_setLoop(_b6){if(this.on())this._b.setLoop(_b6)}function mo_setPanelDisplay(_cI){if(this.on())this._b.setPanelDisplay(_cI)}function mo_setPanelMode(_cJ){if(this.on())this._b.setPanelMode(_cJ)}function mo_setPosition(_cK){if(this.on())this._b.setPosition(_cK)}function mo_setPlayer(_b){this._b=_b}function mo_setReverbType(_cL){if(MO_N())MO_j.global.setReverbType(_cL)}function mo_setStartTime(_cM){if(this.on())this._b.setStartTime(_cM)}function mo_setTempo(_cN){if(this.on())this._b.setTempo(_cN)}
function mo_setTrackMute(_cE,_b6){if(this.on())this._b.setTrackMute(_cE,_b6)}function mo_setTrackSolo(_cE,_b6){if(this.on())this._b.setTrackSolo(_cE,_b6)}function mo_setTranspose(_cO){if(this.on())this._b.setTranspose(_cO)}function mo_setTransposable(_b5,_b6){if(this.on())this._b.setTransposable(_b5,_b6)}MO_j.meetsMinVersion=MO_j.stringHasAny=MO_g;MO_j.global=null;MO_j.minFadeInterval=100;MO_j.publicInstanceCallbacks=new Array();MO_j.publicStaticCallbacks=new Array();MO_j.addEventHandler=MO_k;MO_j.addInstanceExtender=MO_A;MO_j.addPrivateInstanceMethods=MO_v;MO_j.addPublicCallbacks=MO_B;MO_j.addPublicInstanceMethods=MO_u;MO_j.addPublicStaticMethods=MO_t;MO_j.appendToArray=MO_s;MO_j.arrayOfObjects=MO_z;MO_j.clearTimeout=MO_D;MO_j.doNothing=MO_e;MO_j.execCallback=mo_execCallback;MO_j.execHandler=MO_C;MO_j.globalThru=MO_N;MO_j.indexOf=MO_d;MO_j.isInstance=MO_a;MO_j.parseAttributes=MO_o;MO_j.tagAttr=MO_n;MO_j.wireMethod=MO_r;MO_j._bU=new Array();MO_j._by=new Array();MO_j._ci=0;MO_j._cl=32;
MO_j.voices=MO_j._ce=MO_z(MO_j._cl,MO_L);MO_j._cf=new MO_L();MO_j._t=true;mo_playNote=mo_noteOn;MO_u('addCallbackHandler','doMenuItem','fadeTo','fadeVolume','getAutostart','getChannelMute','getChannelSolo','getController','getFileSize','getInfo','getLoop','getMonophonic','getPanelDisplay','getPanelMode','getPlayLength','getPosition','getProgram','getTempo','getTrackMute','getTrackSolo','getTransposable','getTranspose','getVolume','isPaused','isPlaying','noteOff','noteOn','playNote','preloadEmbed','setAutostart','setChannelMute','setChannelSolo','setController','setEndTime','setLoop','setMonophonic','setPanelDisplay','setPanelMode','setPosition','setProgram','setStartTime','setTempo','setTrackMute','setTrackSolo','setTransposable','setTranspose','stubEmbed');MO_B('[instance]','onLoad','onAudibleStateChange','onMetaEvent','onOutputVolumeChange','onPause','onPlay','onReady','onStop','[static]','onAudioEngagedChange','onEngageAudio');MO_v('execMetaEventHandlers','execOnMetaEvent','getPlayer','setPlayer');
function MO_O(_q){_q._b8=MO_z(17,false);_q._bX=new MO_J();_q._bH=_q.averageNoteRelease=0;_q.usage='music';_q.audible=false;_q.addCallbackHandler('onOutputVolumeChange',_q.objectName+'.updateAudibleState ()');}MO_A(MO_O);MO_t('addCallbackHandler','engageAudio','getAudioDevicePriority','getNoteName','getNoteNumber','getReverbType','isAudioDeviceShared','isAudioEngaged','isAudioSupported','kill','setAudioDevicePriority','setGlobalMute','setReverbType','stopAll');MO_j.Fade=MO_J;
